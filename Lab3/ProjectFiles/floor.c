#include "floor.h"

int16_t FLOOR(int16_t X) { return (NUM_FLOORS-X); }


extern tContext sContext;
extern osMutexId context_mutex;

const uint8_t floor[] = {
	0x34,0x6c,0x8c,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x94,0x34,0x70,0x90
,0x40,0x84,0xa8,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x88,0xb0
,0x40,0x84,0xa8,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x88,0xb0
,0x40,0x84,0xa8,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x8c,0xb4,0x40,0x88,0xb0

};


uint32_t floorOneChannel[1152];
void drawFloor(uint8_t base_height)
{
    int i, j;
	int numberOfPixels;

	numberOfPixels = sizeof(floor)/sizeof(unsigned char);
	j = 0;
    for (i = 0; i < numberOfPixels - 3; i+=3)
    {
        floorOneChannel[j] = (floor[i]<<16) + (floor[i+1]<<8) + (floor[i+2]);
        j++;
    }
    
    GrContextBackgroundSet(&sContext, ClrBlack);
    
	
    for (i = 0; i < FLOOR_HEIGHT; i++)
    {
        for (j = 0; j < FLOOR_WIDTH; j++)
        {
            GrContextForegroundSet(&sContext, floorOneChannel[i*FLOOR_WIDTH + j]);
            GrPixelDraw(&sContext,j,i+base_height);
        }
    }
}

void Floor(void)
{
	uint8_t i, base_height;
	for (i = 0; i < NUM_FLOORS; i++)
	{
		base_height = FLOOR_BASE_PIXEL + 21*i;
		osMutexWait(context_mutex, osWaitForever);
		drawFloor(base_height);
		osMutexRelease(context_mutex);
	}	
}
